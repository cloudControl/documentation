# MongoLab

MongoLab is the cloud-hosted MongoDB solution you've been looking for! MongoLab provides everything you need to make managing your database and data remarkable easy.

## Adding MongoLab

The MongoLab Add-on can be added to any deployment from the cctrlapp command line:

~~~
$ cctrlapp APP_NAME/DEP_NAME addon.add mongolab.OPTION
~~~

For your OPTION, select one of MongoLab's plan offerings: free, small, medium, large, xlarge. For more information, click [here](https://www.cloudcontrol.com/add-ons/mongolab).

## For example:

~~~
$ cctrlapp APP_NAME/DEP_NAME addon.add mongolab.large
~~~

When added, MongoLab automatically creates a new user account and database in an Amazon EC2 cloud. You can manage your database and data easily from the [web console](https://www.cloudcontrol.com/console) by clicking the MongoLab add-on entry on your app's deployment page, and you gain immediate access to MongoLab customer support. Email [support@mongolab.com](mailto:support@mongolab.com) with any questions.

## Internal access credentials

Your MongoLab database connection URI is provided in the CRED_FILE environment variable, a JSON document that stores credentials from your add-on providers. This allows you to avoid hard-coding.

Note: In the event that MongoLab must update your MONGOLAB_URI, you will be notified through the email address you\92ve provided to CloudControl.

MongoLab's entry in your application CRED_FILE looks like this:

~~~
{
 "MONGOLAB":{
   "MONGOLAB_URI":"mongodb://APP_NAME:PASSWORD@ds031947.mongolab.com:31947//DBNAME",
 }
}
~~~

Your app-name, password and db-name are all automatically generated by dotCloud and MongoLab.

## Sample

Here's a snippet of code to get you started:

~~~
<?php
$credfile = file_get_contents($_ENV['CRED_FILE'], false);
$credentials = json_decode($credfile, true);
$uri = $credentials["MONGOLAB"]["MONGOLAB_URI"];
$m = new Mongo($uri);
$db = $m->selectDB(myDbName);
$col = new MongoCollection($db, myCollection);
$cursor = $col->find();
foreach ($cursor as $doc) { echo $doc, "</br>"; }
?> 
~~~

## Upgrading to a larger MongoLab plan

Currently, automatic plan changes are not supported by MongoLab.

There are steps to follow if you've outgrown or anticipate outgrowing your current plan. First, stop your app and any other processes running against your database. Then:

* Backup your database 
* Remove your existing Add-on 
* Add a new Add-on (see available plans here) 
* Restore your database 
* Redeploy your app

Providing you're using the MONGOLAB_URI from your CRED_FILE, no application changes are required.

## Removing MongoLab

If you'd like to remove the MongoLab add-on, use the cctrlapp command line:

~~~
$ cctrlapp APP_NAME/DEP_NAME addon.remove mongolab.OPTION
~~~

Note: All data in your database will be lost if you remove the MongoLab add-on.

